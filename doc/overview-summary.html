<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>erlwitness</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="EDoc">
</head>
<body bgcolor="white">
<div class="navbar"><a name="#navbar_top"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<h1>erlwitness</h1>
<p>Copyright Â© 2015 Guilherme Andrade</p>
<p><b>Version:</b> 1.0.0</p>
<p><b>Authors:</b> Guilherme Andrade (<a href="mailto:erlwitness(at)gandrade(dot)net"><tt>erlwitness(at)gandrade(dot)net</tt></a>).</p>
<p><code>erlwitness</code>: On-demand semantic process group watchtower </p>

<hr>

<h3><a name="What_does_it_do?">What does it do?</a></h3><p>
<code>erlwitness</code> allows one to conveniently funnel <code>gen_server</code> events (init, calls, casts, info, state changes) specific to one or more entities (user_id, person_name, whatever you want to use) into arbitrary watcher processes.</p>

<h3><a name="How_do_I_use_it?">How do I use it?</a></h3><p>
There are two main parts to an ordinary setup:</p>

<p>1) Adapt your existing gen_server:start / gen_server:start_link calls to make use of the relevant registration;</p>

<pre lang="erlang">
% ....
start_link(Person, Files, LuckyNumber) -&gt;
    {WrappedArgs, StartOptions} = erlwitness:get_start_extras(Person, person_file_serv,
                                                              [Files, LuckyNumber]),
    gen_server:start_link(?MODULE, WrappedArgs, StartOptions).

init(WrappedArgs) -&gt;
    [Files, LuckyNumber] = erlwitness:unwrap_init_args(WrappedArgs),
    InitResult = {ok, #state{files = Files,
                             lucky_number = LuckyNumber}},
    erlwitness:finalize_init(WrappedArgs, InitResult).
% ....
</pre>

<p>2) Code your own watcher process which will implement both <code>gen_server</code> and <code>erlwitness_watcher</code> behaviours.</p>

<pre lang="erlang">
% ...
start_link(Person) -&gt;
    erlwitness_watcher:start_link([Person], ?MODULE, []).

% ...

handle_gencall_event(Timestamp, Entity, EntityPid, EntityProcType, 
                     EntityProcName, Call, From, State) -&gt;
    io:format("I watch everything: ~p~n", [{Timestamp, Entity, EntityPid, 
                                            EntityProcType, Call, From}]),
    {noreply, State}.

% ..etc.
</pre>

<hr>
<div class="navbar"><a name="#navbar_bottom"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<p><i>Generated by EDoc, Oct 11 2015, 03:54:15.</i></p>
</body>
</html>
